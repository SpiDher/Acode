import requests

# Your Bearer Token
bearer_token = 'YOUR_BEARER_TOKEN'

# Define the search parameters
query = 'your_keyword'
start_time = '2024-09-01T00:00:00Z'  # Replace with your start time in UTC
end_time = '2024-09-10T00:00:00Z'    # Replace with your end time in UTC
max_results = 10  # Number of tweets to return, max is 100 per request

# Set up the headers
headers = {
    'Authorization': f'Bearer {bearer_token}',
}

# Define the search endpoint and parameters
url = 'https://api.twitter.com/2/tweets/search/recent'
params = {
    'query': query,
    'start_time': start_time,
    'end_time': end_time,
    'max_results': max_results,
    'tweet.fields': 'created_at,text',
    'expansions': 'author_id',
    'user.fields': 'username'
}

# Make the request
response = requests.get(url, headers=headers, params=params)

# Check if the request was successful
if response.status_code == 200:
    tweets = response.json()
    
    # Get the user ID to username mapping
    users = {user['id']: user['username'] for user in tweets['includes']['users']}
    
    # Loop through the tweets and print the tweet text and username
    for tweet in tweets['data']:
        user_id = tweet['author_id']
        username = users.get(user_id, 'Unknown')
        print(f"@{username} tweeted: {tweet['text']} at {tweet['created_at']}")
else:
    print(f"Failed to fetch tweets: {response.status_code} - {response.text}")